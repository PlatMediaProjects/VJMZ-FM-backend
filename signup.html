<form id="signupForm" onsubmit="return false;">
  <!-- your inputs ... -->
</form>
<div id="signupStatus"></div>
<script>
document.addEventListener('DOMContentLoaded', () => {
  const form = document.getElementById('signupForm');
  const statusEl = document.getElementById('signupStatus');

  if (!form) {
    console.error('signupForm not found');
    return;
  }

  // Safety: neutralize any residual action/method
  form.setAttribute('action', 'javascript:void(0)');
  form.setAttribute('method', 'get');

  form.addEventListener('submit', async (e) => {
    e.preventDefault();
    statusEl && (statusEl.textContent = 'Sending…');

    try {
      // Collect values (adjust names if yours differ)
      const first = (form.firstName?.value || '').trim();
      const last  = (form.lastName?.value  || '').trim();
      const email = (form.email?.value     || '').trim();
      const phone = (form.phone?.value     || '').trim();

      if (!email) {
        statusEl.textContent = 'Please enter a valid email.';
        return;
      }

      const payload = {
        name: (first || last) ? `${first} ${last}`.trim() : email,
        email,
        phone,
        message: 'Newsletter / Fan signup from signup.html'
      };

      console.log('Submitting to API with payload:', payload);

      const res = await fetch('https://api.vjmz-fm.com/api/contact', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(payload),
        keepalive: true
      });

      const text = await res.text();
      let data = {}; try { data = JSON.parse(text); } catch {}

      console.log('API response status:', res.status, 'body:', text);

      if (!res.ok) {
        throw new Error(data.error || `HTTP ${res.status}`);
      }

      statusEl.textContent = '✅ Thank you! Your signup was received.';
      form.reset();
    } catch (err) {
      console.error('Signup submit error:', err);
      statusEl.textContent = '❌ Something went wrong. Please try again.';
    }
  });
});
</script>
